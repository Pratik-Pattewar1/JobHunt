<!DOCTYPE html>
<html>
<head>
<title>Admin Dashboard</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body{
    background:#f6f6ff;
}

.card{
    box-shadow:0 2px 5px rgba(0,0,0,.2);
}

.status-approved{
    color:green;
    font-weight:600;
}

.status-rejected{
    color:red;
    font-weight:600;
}
</style>

</head>

<body class="container py-4">
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% set category, message = messages[-1] %}

    <div id="toast"
      style="
        position:fixed;
        top:15px;
        right:20px;
        z-index:9999;
        padding:12px 18px;
        border-radius:8px;
        color:white;
        font-weight:600;
        box-shadow:0 3px 8px rgba(0,0,0,0.2);
        {% if category=='success' %} background:#28a745;
        {% elif category=='danger' %} background:#dc3545;
        {% elif category=='warning' %} background:#ffc107; color:black;
        {% else %} background:#17a2b8;
        {% endif %}
    ">
      {{ message }}
    </div>

    <script>
      setTimeout(() => {
        let t = document.getElementById("toast");
        if(t){ t.style.display="none"; }
      }, 3000);
    </script>

  {% endif %}
{% endwith %}



<h2>Admin Dashboard</h2>
<hr>


<!-- NAVIGATION -->
<div class="mb-4">
    <a href="/job-post" class="btn btn-primary">Post New Job</a>
    <a href="/" class="btn btn-secondary">Back to Home</a>
</div>


<!-- JOB LIST SECTION -->
<div class="card mb-4">
<div class="card-header bg-dark text-white">
    Posted Jobs
</div>

<div class="card-body">

<table class="table table-bordered">
<thead>
<tr>
    <th>ID</th>
    <th>Job Title</th>
    <th>Role</th>
    <th>Skills</th>
    <th>Vacancy</th>
</tr>
</thead>

<tbody>
{% for job in jobs %}
<tr>
    <td>{{ job.id }}</td>
    <td>{{ job.job_title }}</td>
    <td>{{ job.job_role }}</td>
    <td>{{ job.skills }}</td>
    <td>{{ job.vacancy }}</td>
</tr>
{% endfor %}
</tbody>

</table>

</div>
</div>



<!-- APPLICANTS SECTION -->
<div class="card">
<div class="card-header bg-dark text-white">
    Job Applicants
</div>

<div class="card-body">

<table class="table table-bordered">
<thead>
<tr>
    <th>ID</th>
    <th>Name</th>
    <th>Email</th>
    <th>Job Title</th>
    <th>Skills</th>
    <th>Status</th>
    <th>Action</th>
</tr>
</thead>

<tbody>

{% for app in applicants %}
<tr>
    <td>{{ app.id }}</td>
    <td>{{ app.name }}</td>
    <td>{{ app.email }}</td>
    <td>{{ app.job_title }}</td>
    <td>{{ app.skills }}</td>

    <td>
        {% if app.status == 'Approved' %}
            <span class="status-approved">{{ app.status }}</span>
        {% elif app.status == 'Rejected' %}
            <span class="status-rejected">{{ app.status }}</span>
        {% else %}
            {{ app.status }}
        {% endif %}
    </td>

    <td>
        <a href="/approve/{{ app.id }}" class="btn btn-success btn-sm">Approve</a>
        <a href="/reject/{{ app.id }}" class="btn btn-danger btn-sm">Reject</a>
    </td>
</tr>
{% endfor %}

</tbody>
</table>

</div>
</div>

<!-- GLOBAL TOAST -->
<div id="toast"
     style="position:fixed;
            bottom:25px;
            right:25px;
            padding:14px 18px;
            border-radius:10px;
            color:white;
            font-weight:600;
            display:none;
            box-shadow:0 4px 10px rgba(0,0,0,0.25);
            z-index:99999;">
</div>

<script>
  function showToast(msg, type){

    let toast = document.getElementById("toast");

    toast.innerHTML = msg;

    if(type === "success")
        toast.style.background = "#28a745";
    else if(type === "error")
        toast.style.background = "#dc3545";
    else
        toast.style.background = "#17a2b8";

    toast.style.display = "block";

    setTimeout(()=> toast.style.display="none", 2000);
  }
</script>
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% set category, msg = messages[-1] %}
    <script>
        showToast("{{ msg }}", "{{ category }}")
    </script>
  {% endif %}
{% endwith %}

</body>
</html>


